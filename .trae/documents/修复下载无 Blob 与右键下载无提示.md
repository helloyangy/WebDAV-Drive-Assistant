## 现象与定位
- 顶部下载报“未获得可下载的数据（Blob）”：说明前端在 `downloadItem()` 内拿到的 `download`/`downloadCached` 返回值里没有可用的二进制数据。
- 右键下载“没反应”：当前 `setStatus()` 只在“连接中/连接失败/错误”时才显示顶部提示；“下载中/完成”不会显示，用户会感觉点击无效。

## 根因判断
- MV3 的消息传递对 `Blob` 兼容性/跨上下文可用性不稳定：即使后台返回了 `blob`，前端收到的也可能不是可直接 `createObjectURL` 的对象。
- `downloadCached` 即使缓存为空也可能表现为成功（需要明确失败/或由前端自行读取缓存），会导致下载流程拿不到数据。

## 修复方案
### 1) 改为传递 ArrayBuffer（稳定的结构化克隆类型）
- 后台 `download`：`client.get(path)` 得到 `Blob` 后转换为 `ArrayBuffer`（以及携带 `contentType`/文件名等元信息），返回给前端。
- 前端 `downloadItem`：用 `new Blob([arrayBuffer], { type })` 重新组装 Blob，再 `URL.createObjectURL()` 下载。
- 可选：前端用现有 IndexedDB 缓存模块把该 Blob 写入缓存（由 popup 页面写，避免后台写入失败/不可见）。

### 2) 让右键/顶部下载“有反馈”
- 调整 `setStatus()` 的显示策略：除“已连接/未连接”这类常驻状态外，其它操作状态（下载/上传/删除/复制/完成/错误）都在顶部提示区域展示，保证用户能看到“下载中…”与错误信息。

### 3) 统一右键与顶部下载路径
- 保持两者都调用同一个 `downloadItem()`，确保逻辑一致；并在右键菜单点击时先关闭菜单再触发状态提示。

## 验证方式
- 在弹窗中选中文件，分别点击顶部“下载”和右键“下载”，确认：
  - 顶部提示出现“下载中…/完成”
  - 不再出现 `createObjectURL` 相关报错
  - 下载能弹出保存对话框并得到正确文件

如果你确认，我将按以上步骤修改 `background.js` 与 `popup.js` 两个文件完成修复。